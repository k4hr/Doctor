// prisma/schema.prisma
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum DoctorStatus {
  PENDING     // анкета создана, но не отправлена / или ожидает модерацию
  NEED_FIX    // модератор запросил правки
  APPROVED    // одобрен
  REJECTED    // отклонён окончательно
}

model Doctor {
  // --------------------
  // Системные поля
  // --------------------
  id          String       @id @default(cuid())
  createdAt   DateTime     @default(now())
  updatedAt   DateTime     @updatedAt
  submittedAt DateTime?    // реально отправлено на модерацию (после загрузки доков)
  status      DoctorStatus @default(PENDING)

  // --------------------
  // Telegram
  // --------------------
  telegramId        String  @unique
  telegramUsername  String?
  telegramFirstName String?
  telegramLastName  String?

  // --------------------
  // Личные данные
  // --------------------
  lastName   String
  firstName  String
  middleName String?
  gender     String        // male / female (строка, без enum — гибче)
  birthDay   Int?
  birthMonth Int?
  birthYear  Int?
  city       String?

  // --------------------
  // Профессиональные данные
  // --------------------
  speciality1     String
  speciality2     String?
  speciality3     String?
  education       String
  degree          String?  // none / specialist / candidate / doctor
  workplace       String?
  position        String?
  experienceYears Int
  awards          String?

  // --------------------
  // Контакты
  // --------------------
  email String

  // --------------------
  // Описание профиля
  // --------------------
  about             String
  specialityDetails String
  experienceDetails String
  courses           String?
  achievements      String?
  publications      String?

  // --------------------
  // Документы (после шага docs)
  // --------------------
  profilePhotoUrl String?
  diplomaPhotoUrl String?

  // --------------------
  // Индексы
  // --------------------
  @@index([status])
  @@index([speciality1])
  @@index([city])
  @@index([submittedAt])
}
